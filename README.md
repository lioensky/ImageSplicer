# 图片拼接工具 (Image Splicer)

一个简单的Windows桌面应用程序，用于将多张图片拼接成一张图片，支持多种拼接模式和自定义选项。

## 主要功能

*   **添加图片**:
    *   通过“添加图片”按钮选择本地图片文件。
    *   支持拖拽图片文件到左侧列表。
    *   支持粘贴图片文件路径 (Ctrl+V)。
    *   支持直接粘贴剪贴板中的图片数据 (例如截图, Ctrl+V)。
*   **拼接模式**:
    *   横向拼接
    *   纵向拼接
    *   2xN网格 (紧凑型左上角优先填充布局)
*   **预览**:
    *   右侧大预览区域显示拼接后的效果。
    *   左侧列表下方显示当前选中图片的缩略图。
*   **序号水印**:
    *   可选在每张原始图片的左上角添加序号水印 (如 "图1", "图2")。
    *   支持选择水印颜色 (红色、白色、黑色)。
*   **保存**:
    *   可选择保存为 PNG (支持透明背景) 或 JPG 格式。
*   **复制**:
    *   可将拼接后的图片复制到剪贴板 (Windows)。

## 环境要求

*   Python 3.x
*   Windows 操作系统 (部分功能如剪贴板复制和无控制台启动针对Windows优化)

## 安装依赖

在项目根目录下 (与 `requirements.txt` 文件同级)，打开命令行工具，然后运行：

```bash
pip install -r requirements.txt
```

这将安装以下必要的Python库：
*   `Pillow` (用于图片处理)
*   `pywin32` (用于Windows剪贴板操作)
*   `tkinterdnd2` (用于拖拽功能)

## 如何运行

1.  **确保依赖已安装** (见上一节)。
2.  **字体文件 (重要)**:
    *   为了序号水印能正确显示中文字符 (如 "图"), 请确保名为 `msyh.ttf` (微软雅黑) 的字体文件与 `image_splicer_app.py` 脚本在**同一目录**下。
    *   如果您使用的是其他名称的微软雅黑字体文件 (例如 `微软雅黑.ttf`), 请将其重命名为 `msyh.ttf`，或者修改 `image_splicer_app.py` 脚本中加载字体的代码部分。
3.  **启动程序**:
    *   **推荐方式**: 直接双击项目中的 `run_image_splicer.bat` 文件。此脚本会以无命令行窗口的方式启动程序。
    *   **备用方式 (会显示命令行窗口)**: 打开命令行工具，导航到项目根目录，然后运行：
        ```bash
        python image_splicer_app.py
        ```

## 文件说明

*   `image_splicer_app.py`:主要的Python应用程序脚本。
*   `requirements.txt`: 项目依赖库列表。
*   `run_image_splicer.bat`: Windows批处理脚本，用于无控制台窗口启动应用程序。
*   `msyh.ttf` (用户需自行准备): 微软雅黑字体文件，用于水印中的中文字符显示。